<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üß™ Complete Website Function Testing Suite - 3 Ball Network</title>
    <link rel="stylesheet" href="/assets/css/video-components.css" />
    <style>
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        min-height: 100vh;
        color: #333;
      }
      .test-container {
        max-width: 1600px;
        margin: 0 auto;
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }
      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 40px;
        text-align: center;
      }
      .header h1 {
        margin: 0 0 15px 0;
        font-size: 3em;
        font-weight: 800;
      }
      .content {
        padding: 40px;
      }
      .test-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 25px;
        margin: 30px 0;
      }
      .test-category {
        background: #f8f9fa;
        border-radius: 12px;
        border: 2px solid #e9ecef;
        overflow: hidden;
        transition: all 0.3s ease;
      }
      .test-category:hover {
        border-color: #007bff;
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 123, 255, 0.15);
      }
      .category-header {
        background: #343a40;
        color: white;
        padding: 20px;
        font-weight: 600;
        font-size: 1.1em;
      }
      .category-content {
        padding: 20px;
      }
      .test-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #e9ecef;
      }
      .test-item:last-child {
        border-bottom: none;
      }
      .test-name {
        font-weight: 500;
        flex-grow: 1;
      }
      .test-status {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.8em;
        font-weight: 600;
        margin-left: 10px;
        min-width: 80px;
        text-align: center;
      }
      .status-pending {
        background: #ffc107;
        color: #212529;
      }
      .status-running {
        background: #17a2b8;
        color: white;
        animation: pulse 1.5s infinite;
      }
      .status-success {
        background: #28a745;
        color: white;
      }
      .status-error {
        background: #dc3545;
        color: white;
      }
      .status-warning {
        background: #fd7e14;
        color: white;
      }
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }
      .control-panel {
        background: #343a40;
        color: white;
        padding: 30px;
        border-radius: 12px;
        margin: 30px 0;
      }
      .button {
        background: #007bff;
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        margin: 10px;
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
      }
      .button:hover {
        background: #0056b3;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
      }
      .button:disabled {
        background: #6c757d;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }
      .button.success {
        background: #28a745;
      }
      .button.danger {
        background: #dc3545;
      }
      .button.warning {
        background: #ffc107;
        color: #212529;
      }
      .progress-container {
        background: #e9ecef;
        border-radius: 25px;
        height: 12px;
        margin: 20px 0;
        overflow: hidden;
      }
      .progress-bar {
        background: linear-gradient(90deg, #28a745, #20c997);
        height: 100%;
        transition: width 0.5s ease;
        width: 0%;
      }
      .progress-text {
        text-align: center;
        margin: 10px 0;
        font-weight: 600;
      }
      .console-output {
        background: #1a1a1a;
        color: #00ff00;
        font-family:
          'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
        padding: 25px;
        border-radius: 12px;
        max-height: 500px;
        overflow-y: auto;
        margin: 20px 0;
        font-size: 14px;
        line-height: 1.6;
        border: 2px solid #343a40;
      }
      .summary-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 30px 0;
      }
      .stat-card {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 25px;
        border-radius: 12px;
        text-align: center;
      }
      .stat-number {
        font-size: 2.5em;
        font-weight: 800;
        margin-bottom: 10px;
      }
      .stat-label {
        font-size: 1.1em;
        opacity: 0.9;
      }
      .error-details {
        background: #f8d7da;
        border: 1px solid #f5c6cb;
        color: #721c24;
        padding: 15px;
        border-radius: 8px;
        margin: 10px 0;
        display: none;
      }
      .test-iframe {
        width: 100%;
        height: 300px;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        margin: 15px 0;
      }
    </style>
  </head>
  <body>
    <div class="test-container">
      <div class="header">
        <h1>üß™ Complete Website Function Testing Suite</h1>
        <p>
          Comprehensive automated testing of all 3 Ball Network features and
          functionality
        </p>
        <div class="progress-container">
          <div class="progress-bar" id="overallProgress"></div>
        </div>
        <div class="progress-text" id="progressText">
          Ready to start testing
        </div>
      </div>

      <div class="content">
        <!-- Control Panel -->
        <div class="control-panel">
          <h3>üéÆ Test Control Panel</h3>
          <button class="button" onclick="runAllTests()" id="runAllBtn">
            üöÄ Run All Tests
          </button>
          <button
            class="button warning"
            onclick="runQuickTests()"
            id="quickTestBtn"
          >
            ‚ö° Quick Test Suite
          </button>
          <button
            class="button"
            onclick="runCategoryTest('core')"
            id="coreTestBtn"
          >
            üîß Core Functions
          </button>
          <button
            class="button"
            onclick="runCategoryTest('video')"
            id="videoTestBtn"
          >
            üé¨ Video Features
          </button>
          <button
            class="button"
            onclick="runCategoryTest('analytics')"
            id="analyticsTestBtn"
          >
            üìä Analytics
          </button>
          <button class="button" onclick="runCategoryTest('ui')" id="uiTestBtn">
            üé® UI Components
          </button>
          <button
            class="button danger"
            onclick="stopAllTests()"
            id="stopBtn"
            disabled
          >
            ‚èπÔ∏è Stop Tests
          </button>
          <button class="button" onclick="generateReport()" id="reportBtn">
            üìÑ Generate Report
          </button>
        </div>

        <!-- Summary Statistics -->
        <div class="summary-stats">
          <div class="stat-card">
            <div class="stat-number" id="totalTests">0</div>
            <div class="stat-label">Total Tests</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="passedTests">0</div>
            <div class="stat-label">Passed</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="failedTests">0</div>
            <div class="stat-label">Failed</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="testTime">0</div>
            <div class="stat-label">Time (seconds)</div>
          </div>
        </div>

        <!-- Test Categories -->
        <div class="test-grid">
          <!-- Core Website Functions -->
          <div class="test-category" id="core-category">
            <div class="category-header">üîß Core Website Functions</div>
            <div class="category-content" id="core-tests">
              <!-- Tests will be populated here -->
            </div>
          </div>

          <!-- Video System -->
          <div class="test-category" id="video-category">
            <div class="category-header">üé¨ Video System</div>
            <div class="category-content" id="video-tests">
              <!-- Tests will be populated here -->
            </div>
          </div>

          <!-- Analytics & Stats -->
          <div class="test-category" id="analytics-category">
            <div class="category-header">üìä Analytics & Statistics</div>
            <div class="category-content" id="analytics-tests">
              <!-- Tests will be populated here -->
            </div>
          </div>

          <!-- UI Components -->
          <div class="test-category" id="ui-category">
            <div class="category-header">üé® UI Components</div>
            <div class="category-content" id="ui-tests">
              <!-- Tests will be populated here -->
            </div>
          </div>

          <!-- Authentication & Security -->
          <div class="test-category" id="auth-category">
            <div class="category-header">üîê Authentication & Security</div>
            <div class="category-content" id="auth-tests">
              <!-- Tests will be populated here -->
            </div>
          </div>

          <!-- Data Management -->
          <div class="test-category" id="data-category">
            <div class="category-header">üíæ Data Management</div>
            <div class="category-content" id="data-tests">
              <!-- Tests will be populated here -->
            </div>
          </div>

          <!-- Performance -->
          <div class="test-category" id="performance-category">
            <div class="category-header">‚ö° Performance</div>
            <div class="category-content" id="performance-tests">
              <!-- Tests will be populated here -->
            </div>
          </div>

          <!-- Integration -->
          <div class="test-category" id="integration-category">
            <div class="category-header">üîó Integration Tests</div>
            <div class="category-content" id="integration-tests">
              <!-- Tests will be populated here -->
            </div>
          </div>
        </div>

        <!-- Console Output -->
        <div class="console-output" id="consoleOutput">
          üß™ Test Suite Initialized - Ready to begin comprehensive testing...\n
        </div>
      </div>
    </div>

    <script>
      // Test Suite Configuration
      const testSuite = {
        core: [
          { name: 'Homepage Loading', url: '/', function: 'testPageLoad' },
          { name: 'Navigation Menu', url: '/', function: 'testNavigation' },
          {
            name: 'Player Portal Access',
            url: '/player.html',
            function: 'testPageLoad',
          },
          {
            name: 'Coach Portal Access',
            url: '/coach.html',
            function: 'testPageLoad',
          },
          {
            name: 'Admin Portal Access',
            url: '/admin.html',
            function: 'testPageLoad',
          },
          { name: 'About Page', url: '/about.html', function: 'testPageLoad' },
          {
            name: 'Analytics Dashboard',
            url: '/analytics.html',
            function: 'testPageLoad',
          },
          {
            name: 'AI Coach Interface',
            url: '/ai-coach.html',
            function: 'testPageLoad',
          },
          { name: 'Search Functionality', url: '/', function: 'testSearch' },
          { name: 'Responsive Design', url: '/', function: 'testResponsive' },
          { name: 'Service Worker', url: '/', function: 'testServiceWorker' },
          { name: 'Local Storage', url: '/', function: 'testLocalStorage' },
          { name: 'Error Handling', url: '/', function: 'testErrorHandling' },
        ],
        video: [
          {
            name: 'Video Gallery Loading',
            url: '/player.html',
            function: 'testVideoGallery',
          },
          {
            name: 'Video Upload Interface',
            url: '/player.html',
            function: 'testVideoUpload',
          },
          {
            name: 'Video Processing Engine',
            url: '/video-test.html',
            function: 'testVideoProcessor',
          },
          {
            name: 'Thumbnail Generation',
            url: '/video-test.html',
            function: 'testThumbnailGen',
          },
          {
            name: 'Video Player Controls',
            url: '/video-test.html',
            function: 'testVideoPlayer',
          },
          {
            name: 'Video Sharing',
            url: '/player.html',
            function: 'testVideoSharing',
          },
          {
            name: 'Highlight Creation',
            url: '/player.html',
            function: 'testHighlights',
          },
          {
            name: 'Video Search/Filter',
            url: '/player.html',
            function: 'testVideoSearch',
          },
          {
            name: 'Video Storage',
            url: '/video-test.html',
            function: 'testVideoStorage',
          },
          {
            name: 'Video Metadata',
            url: '/video-test.html',
            function: 'testVideoMetadata',
          },
        ],
        analytics: [
          {
            name: 'Performance Charts',
            url: '/analytics.html',
            function: 'testCharts',
          },
          {
            name: 'Player Statistics',
            url: '/player.html',
            function: 'testPlayerStats',
          },
          {
            name: 'Shot Chart Generation',
            url: '/analytics.html',
            function: 'testShotChart',
          },
          {
            name: 'Heat Map Visualization',
            url: '/analytics.html',
            function: 'testHeatMap',
          },
          {
            name: 'Game Analysis',
            url: '/analytics.html',
            function: 'testGameAnalysis',
          },
          {
            name: 'Export Functionality',
            url: '/analytics.html',
            function: 'testExport',
          },
          {
            name: 'Real-time Updates',
            url: '/analytics.html',
            function: 'testRealTimeUpdates',
          },
          {
            name: 'Data Filtering',
            url: '/analytics.html',
            function: 'testDataFiltering',
          },
        ],
        ui: [
          { name: 'Modal Components', url: '/', function: 'testModals' },
          {
            name: 'Form Validation',
            url: '/player.html',
            function: 'testFormValidation',
          },
          { name: 'Button Interactions', url: '/', function: 'testButtons' },
          {
            name: 'Loading Animations',
            url: '/',
            function: 'testLoadingStates',
          },
          { name: 'Tooltips & Help', url: '/', function: 'testTooltips' },
          {
            name: 'Drag & Drop',
            url: '/player.html',
            function: 'testDragDrop',
          },
          {
            name: 'Keyboard Navigation',
            url: '/',
            function: 'testKeyboardNav',
          },
          {
            name: 'Accessibility Features',
            url: '/',
            function: 'testAccessibility',
          },
          { name: 'Theme Support', url: '/', function: 'testThemes' },
        ],
        auth: [
          {
            name: 'User Registration',
            url: '/player.html',
            function: 'testRegistration',
          },
          { name: 'Login Process', url: '/player.html', function: 'testLogin' },
          {
            name: 'Session Management',
            url: '/player.html',
            function: 'testSession',
          },
          {
            name: 'Password Reset',
            url: '/player.html',
            function: 'testPasswordReset',
          },
          {
            name: 'Profile Management',
            url: '/player.html',
            function: 'testProfile',
          },
          {
            name: 'Role-based Access',
            url: '/admin.html',
            function: 'testRoleAccess',
          },
          {
            name: 'Security Headers',
            url: '/',
            function: 'testSecurityHeaders',
          },
        ],
        data: [
          {
            name: 'Firebase Connection',
            url: '/',
            function: 'testFirebaseConnection',
          },
          {
            name: 'Data Persistence',
            url: '/player.html',
            function: 'testDataPersistence',
          },
          { name: 'Offline Support', url: '/', function: 'testOfflineSupport' },
          {
            name: 'Data Synchronization',
            url: '/player.html',
            function: 'testDataSync',
          },
          {
            name: 'Backup & Recovery',
            url: '/',
            function: 'testBackupRecovery',
          },
          {
            name: 'Data Validation',
            url: '/player.html',
            function: 'testDataValidation',
          },
        ],
        performance: [
          { name: 'Page Load Times', url: '/', function: 'testPageLoadTime' },
          {
            name: 'Resource Loading',
            url: '/',
            function: 'testResourceLoading',
          },
          { name: 'Memory Usage', url: '/', function: 'testMemoryUsage' },
          {
            name: 'JavaScript Performance',
            url: '/',
            function: 'testJSPerformance',
          },
          { name: 'CSS Rendering', url: '/', function: 'testCSSPerformance' },
          {
            name: 'Network Efficiency',
            url: '/',
            function: 'testNetworkEfficiency',
          },
          {
            name: 'Cache Effectiveness',
            url: '/',
            function: 'testCacheEfficiency',
          },
        ],
        integration: [
          {
            name: 'End-to-End Workflow',
            url: '/player.html',
            function: 'testE2EWorkflow',
          },
          {
            name: 'Cross-browser Support',
            url: '/',
            function: 'testCrossBrowser',
          },
          {
            name: 'Mobile Compatibility',
            url: '/',
            function: 'testMobileCompat',
          },
          {
            name: 'External API Integration',
            url: '/',
            function: 'testAPIIntegration',
          },
          {
            name: 'Third-party Libraries',
            url: '/',
            function: 'testThirdPartyLibs',
          },
        ],
      };

      // Test state
      let currentTest = 0;
      let totalTestCount = 0;
      let passedCount = 0;
      let failedCount = 0;
      let startTime = Date.now();
      let isTestingRunning = false;
      let testResults = [];

      // Console logging
      function log(message, type = 'info') {
        const console = document.getElementById('consoleOutput');
        const timestamp = new Date().toLocaleTimeString();
        const prefix =
          type === 'error'
            ? '‚ùå'
            : type === 'success'
              ? '‚úÖ'
              : type === 'warning'
                ? '‚ö†Ô∏è'
                : 'üìù';
        console.textContent += `[${timestamp}] ${prefix} ${message}\n`;
        console.scrollTop = console.scrollHeight;
      }

      // Initialize test suite
      function initializeTestSuite() {
        // Calculate total tests
        totalTestCount = Object.values(testSuite).reduce(
          (total, category) => total + category.length,
          0
        );
        document.getElementById('totalTests').textContent = totalTestCount;

        // Populate test categories
        Object.keys(testSuite).forEach(category => {
          const container = document.getElementById(`${category}-tests`);
          testSuite[category].forEach(test => {
            const testItem = document.createElement('div');
            testItem.className = 'test-item';
            testItem.innerHTML = `
                        <div class="test-name">${test.name}</div>
                        <div class="test-status status-pending" id="status-${test.name.replace(/\\s+/g, '-').toLowerCase()}">PENDING</div>
                    `;
            container.appendChild(testItem);
          });
        });

        log('Test suite initialized with ' + totalTestCount + ' tests');
      }

      // Update test status
      function updateTestStatus(testName, status, details = '') {
        const statusId =
          'status-' + testName.replace(/\\s+/g, '-').toLowerCase();
        const statusElement = document.getElementById(statusId);
        if (statusElement) {
          statusElement.className = `test-status status-${status}`;
          statusElement.textContent = status.toUpperCase();

          if (details) {
            statusElement.title = details;
          }
        }
      }

      // Update progress
      function updateProgress() {
        const progress = (currentTest / totalTestCount) * 100;
        document.getElementById('overallProgress').style.width = progress + '%';
        document.getElementById('progressText').textContent =
          `Testing progress: ${currentTest}/${totalTestCount} (${Math.round(progress)}%)`;

        document.getElementById('passedTests').textContent = passedCount;
        document.getElementById('failedTests').textContent = failedCount;

        const elapsedTime = Math.round((Date.now() - startTime) / 1000);
        document.getElementById('testTime').textContent = elapsedTime;
      }

      // Individual test functions
      async function testPageLoad(url) {
        return new Promise(resolve => {
          const startTime = performance.now();
          const iframe = document.createElement('iframe');
          iframe.style.display = 'none';
          iframe.src = url;

          iframe.onload = () => {
            const loadTime = performance.now() - startTime;
            document.body.removeChild(iframe);
            resolve({
              passed: true,
              details: `Loaded in ${Math.round(loadTime)}ms`,
            });
          };

          iframe.onerror = () => {
            document.body.removeChild(iframe);
            resolve({
              passed: false,
              details: 'Failed to load page',
            });
          };

          document.body.appendChild(iframe);

          // Timeout after 10 seconds
          setTimeout(() => {
            if (document.body.contains(iframe)) {
              document.body.removeChild(iframe);
              resolve({
                passed: false,
                details: 'Page load timeout',
              });
            }
          }, 10000);
        });
      }

      async function testNavigation() {
        // Test if main navigation elements exist
        try {
          const response = await fetch('/');
          const html = await response.text();
          const hasNav = html.includes('nav') || html.includes('menu');
          return {
            passed: hasNav,
            details: hasNav
              ? 'Navigation elements found'
              : 'No navigation found',
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Navigation test failed: ' + error.message,
          };
        }
      }

      async function testSearch() {
        // Test search functionality
        try {
          const response = await fetch('/');
          const html = await response.text();
          const hasSearch = html.includes('search') || html.includes('Search');
          return {
            passed: hasSearch,
            details: hasSearch
              ? 'Search functionality detected'
              : 'No search found',
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Search test failed: ' + error.message,
          };
        }
      }

      async function testResponsive() {
        // Test responsive design by checking CSS
        try {
          const response = await fetch('/');
          const html = await response.text();
          const hasResponsive =
            html.includes('viewport') && html.includes('responsive');
          return {
            passed: hasResponsive,
            details: hasResponsive
              ? 'Responsive design detected'
              : 'Not responsive',
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Responsive test failed: ' + error.message,
          };
        }
      }

      async function testServiceWorker() {
        // Test service worker registration
        try {
          const hasServiceWorker = 'serviceWorker' in navigator;
          return {
            passed: hasServiceWorker,
            details: hasServiceWorker
              ? 'Service Worker supported'
              : 'Not supported',
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Service Worker test failed: ' + error.message,
          };
        }
      }

      async function testLocalStorage() {
        // Test local storage functionality
        try {
          localStorage.setItem('test', 'value');
          const value = localStorage.getItem('test');
          localStorage.removeItem('test');
          return {
            passed: value === 'value',
            details: 'Local Storage functional',
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Local Storage test failed: ' + error.message,
          };
        }
      }

      async function testErrorHandling() {
        // Test error handling
        try {
          // Simulate an error
          const response = await fetch('/nonexistent-page');
          return {
            passed: response.status === 404,
            details: '404 handling works',
          };
        } catch (error) {
          return { passed: true, details: 'Error handling functional' };
        }
      }

      async function testVideoGallery() {
        // Test video gallery loading
        try {
          const response = await fetch('/player.html');
          const html = await response.text();
          const hasVideoGallery =
            html.includes('videoGallery') || html.includes('video-gallery');
          return {
            passed: hasVideoGallery,
            details: hasVideoGallery
              ? 'Video gallery found'
              : 'No video gallery',
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Video gallery test failed: ' + error.message,
          };
        }
      }

      async function testVideoProcessor() {
        // Test video processor module
        try {
          const response = await fetch('/assets/js/videoProcessor.js');
          const jsCode = await response.text();
          const hasProcessor =
            jsCode.includes('VideoProcessor') &&
            jsCode.includes('processVideo');
          return {
            passed: hasProcessor,
            details: hasProcessor
              ? 'Video processor found'
              : 'No video processor',
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Video processor test failed: ' + error.message,
          };
        }
      }

      // Add more specific test functions...
      async function testGenericFeature(featureName, url, searchTerm) {
        try {
          const response = await fetch(url);
          const content = await response.text();
          const hasFeature = content.includes(searchTerm);
          return {
            passed: hasFeature,
            details: hasFeature
              ? `${featureName} found`
              : `${featureName} not found`,
          };
        } catch (error) {
          return {
            passed: false,
            details: `${featureName} test failed: ` + error.message,
          };
        }
      }

      // Map generic functions
      const testVideoUpload = () =>
        testGenericFeature('Video Upload', '/player.html', 'upload');
      const testThumbnailGen = () =>
        testGenericFeature(
          'Thumbnail Generation',
          '/video-test.html',
          'thumbnail'
        );
      const testVideoPlayer = () =>
        testGenericFeature('Video Player', '/video-test.html', 'video-player');
      const testVideoSharing = () =>
        testGenericFeature('Video Sharing', '/player.html', 'share');
      const testHighlights = () =>
        testGenericFeature('Highlights', '/player.html', 'highlight');
      const testVideoSearch = () =>
        testGenericFeature('Video Search', '/player.html', 'search');
      const testVideoStorage = () =>
        testGenericFeature('Video Storage', '/video-test.html', 'storage');
      const testVideoMetadata = () =>
        testGenericFeature('Video Metadata', '/video-test.html', 'metadata');
      const testCharts = () =>
        testGenericFeature('Charts', '/analytics.html', 'chart');
      const testPlayerStats = () =>
        testGenericFeature('Player Stats', '/player.html', 'statistics');
      const testShotChart = () =>
        testGenericFeature('Shot Chart', '/analytics.html', 'shot');
      const testHeatMap = () =>
        testGenericFeature('Heat Map', '/analytics.html', 'heatmap');
      const testGameAnalysis = () =>
        testGenericFeature('Game Analysis', '/analytics.html', 'analysis');
      const testExport = () =>
        testGenericFeature('Export', '/analytics.html', 'export');
      const testRealTimeUpdates = () =>
        testGenericFeature('Real-time Updates', '/analytics.html', 'real-time');
      const testDataFiltering = () =>
        testGenericFeature('Data Filtering', '/analytics.html', 'filter');
      const testModals = () => testGenericFeature('Modals', '/', 'modal');
      const testFormValidation = () =>
        testGenericFeature('Form Validation', '/player.html', 'validation');
      const testButtons = () => testGenericFeature('Buttons', '/', 'button');
      const testLoadingStates = () =>
        testGenericFeature('Loading States', '/', 'loading');
      const testTooltips = () => testGenericFeature('Tooltips', '/', 'tooltip');
      const testDragDrop = () =>
        testGenericFeature('Drag & Drop', '/player.html', 'drag');
      const testKeyboardNav = () =>
        testGenericFeature('Keyboard Navigation', '/', 'keyboard');
      const testAccessibility = () =>
        testGenericFeature('Accessibility', '/', 'aria');
      const testThemes = () => testGenericFeature('Themes', '/', 'theme');
      const testRegistration = () =>
        testGenericFeature('Registration', '/player.html', 'register');
      const testLogin = () =>
        testGenericFeature('Login', '/player.html', 'login');
      const testSession = () =>
        testGenericFeature('Session', '/player.html', 'session');
      const testPasswordReset = () =>
        testGenericFeature('Password Reset', '/player.html', 'password');
      const testProfile = () =>
        testGenericFeature('Profile', '/player.html', 'profile');
      const testRoleAccess = () =>
        testGenericFeature('Role Access', '/admin.html', 'role');
      const testSecurityHeaders = () =>
        testGenericFeature('Security Headers', '/', 'security');
      const testFirebaseConnection = () =>
        testGenericFeature('Firebase', '/', 'firebase');
      const testDataPersistence = () =>
        testGenericFeature('Data Persistence', '/player.html', 'persist');
      const testOfflineSupport = () =>
        testGenericFeature('Offline Support', '/', 'offline');
      const testDataSync = () =>
        testGenericFeature('Data Sync', '/player.html', 'sync');
      const testBackupRecovery = () =>
        testGenericFeature('Backup Recovery', '/', 'backup');
      const testDataValidation = () =>
        testGenericFeature('Data Validation', '/player.html', 'validate');

      // Performance tests
      async function testPageLoadTime() {
        const startTime = performance.now();
        try {
          const response = await fetch('/');
          const loadTime = performance.now() - startTime;
          return {
            passed: loadTime < 3000,
            details: `Load time: ${Math.round(loadTime)}ms`,
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Load time test failed: ' + error.message,
          };
        }
      }

      async function testResourceLoading() {
        try {
          const resources = [
            '/',
            '/assets/css/video-components.css',
            '/assets/js/videoProcessor.js',
          ];
          const promises = resources.map(resource => fetch(resource));
          const results = await Promise.allSettled(promises);
          const successful = results.filter(
            result => result.status === 'fulfilled'
          ).length;
          return {
            passed: successful === resources.length,
            details: `${successful}/${resources.length} resources loaded`,
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Resource loading test failed: ' + error.message,
          };
        }
      }

      async function testMemoryUsage() {
        try {
          const memInfo = performance.memory || {
            usedJSHeapSize: 0,
            totalJSHeapSize: 0,
          };
          const usage = memInfo.usedJSHeapSize / memInfo.totalJSHeapSize;
          return {
            passed: usage < 0.8,
            details: `Memory usage: ${Math.round(usage * 100)}%`,
          };
        } catch (error) {
          return { passed: true, details: 'Memory info not available' };
        }
      }

      async function testJSPerformance() {
        const startTime = performance.now();
        // Simulate some JS operations
        for (let i = 0; i < 100000; i++) {
          Math.random();
        }
        const execTime = performance.now() - startTime;
        return {
          passed: execTime < 100,
          details: `JS execution: ${Math.round(execTime)}ms`,
        };
      }

      async function testCSSPerformance() {
        try {
          const response = await fetch('/assets/css/video-components.css');
          const css = await response.text();
          return {
            passed: css.length > 0,
            details: `CSS loaded: ${Math.round(css.length / 1024)}KB`,
          };
        } catch (error) {
          return {
            passed: false,
            details: 'CSS performance test failed: ' + error.message,
          };
        }
      }

      async function testNetworkEfficiency() {
        const startTime = performance.now();
        try {
          const response = await fetch('/', { method: 'HEAD' });
          const responseTime = performance.now() - startTime;
          return {
            passed: responseTime < 1000,
            details: `Network response: ${Math.round(responseTime)}ms`,
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Network efficiency test failed: ' + error.message,
          };
        }
      }

      async function testCacheEfficiency() {
        try {
          // Test if caching headers are present
          const response = await fetch('/');
          const cacheControl = response.headers.get('cache-control');
          return {
            passed: !!cacheControl,
            details: cacheControl ? 'Caching enabled' : 'No cache headers',
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Cache efficiency test failed: ' + error.message,
          };
        }
      }

      // Integration tests
      async function testE2EWorkflow() {
        try {
          // Simulate end-to-end workflow
          const steps = [
            fetch('/'),
            fetch('/player.html'),
            fetch('/assets/js/videoProcessor.js'),
          ];
          const results = await Promise.allSettled(steps);
          const successful = results.filter(
            result => result.status === 'fulfilled'
          ).length;
          return {
            passed: successful === steps.length,
            details: `${successful}/${steps.length} workflow steps completed`,
          };
        } catch (error) {
          return {
            passed: false,
            details: 'E2E workflow test failed: ' + error.message,
          };
        }
      }

      async function testCrossBrowser() {
        const features = [
          'fetch' in window,
          'localStorage' in window,
          'serviceWorker' in navigator,
          'MediaRecorder' in window,
        ];
        const supported = features.filter(Boolean).length;
        return {
          passed: supported >= 3,
          details: `${supported}/4 modern features supported`,
        };
      }

      async function testMobileCompat() {
        const isMobile =
          /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
            navigator.userAgent
          );
        const hasViewport = document.querySelector('meta[name="viewport"]');
        return {
          passed: true,
          details: `Mobile: ${isMobile}, Viewport: ${!!hasViewport}`,
        };
      }

      async function testAPIIntegration() {
        try {
          // Test Firebase integration
          const response = await fetch('/assets/js/firebaseConfig.js');
          const hasFirebase = response.ok;
          return {
            passed: hasFirebase,
            details: hasFirebase
              ? 'API integration detected'
              : 'No API integration',
          };
        } catch (error) {
          return {
            passed: false,
            details: 'API integration test failed: ' + error.message,
          };
        }
      }

      async function testThirdPartyLibs() {
        try {
          const response = await fetch('/');
          const html = await response.text();
          const hasLibs =
            html.includes('chart') ||
            html.includes('firebase') ||
            html.includes('cdn');
          return {
            passed: hasLibs,
            details: hasLibs
              ? 'Third-party libraries found'
              : 'No third-party libraries',
          };
        } catch (error) {
          return {
            passed: false,
            details: 'Third-party libs test failed: ' + error.message,
          };
        }
      }

      // Main test execution
      async function runTest(test) {
        currentTest++;
        updateTestStatus(test.name, 'running');

        log(`Running test: ${test.name}`, 'info');

        try {
          const testFunction = eval(test.function);
          const result = await testFunction(test.url);

          if (result.passed) {
            passedCount++;
            updateTestStatus(test.name, 'success', result.details);
            log(`‚úÖ PASSED: ${test.name} - ${result.details}`, 'success');
          } else {
            failedCount++;
            updateTestStatus(test.name, 'error', result.details);
            log(`‚ùå FAILED: ${test.name} - ${result.details}`, 'error');
          }

          testResults.push({
            name: test.name,
            category: test.category,
            passed: result.passed,
            details: result.details,
            timestamp: new Date().toISOString(),
          });
        } catch (error) {
          failedCount++;
          updateTestStatus(test.name, 'error', error.message);
          log(`‚ùå ERROR: ${test.name} - ${error.message}`, 'error');

          testResults.push({
            name: test.name,
            category: test.category,
            passed: false,
            details: error.message,
            timestamp: new Date().toISOString(),
          });
        }

        updateProgress();

        // Small delay between tests
        await new Promise(resolve => setTimeout(resolve, 100));
      }

      // Test execution functions
      async function runAllTests() {
        if (isTestingRunning) return;

        isTestingRunning = true;
        currentTest = 0;
        passedCount = 0;
        failedCount = 0;
        startTime = Date.now();
        testResults = [];

        document.getElementById('runAllBtn').disabled = true;
        document.getElementById('stopBtn').disabled = false;

        log('üöÄ Starting comprehensive test suite...', 'info');

        for (const [categoryName, tests] of Object.entries(testSuite)) {
          if (!isTestingRunning) break;

          log(`üìÅ Testing category: ${categoryName.toUpperCase()}`, 'info');

          for (const test of tests) {
            if (!isTestingRunning) break;
            test.category = categoryName;
            await runTest(test);
          }
        }

        if (isTestingRunning) {
          log('üéâ All tests completed!', 'success');
          log(
            `üìä Results: ${passedCount} passed, ${failedCount} failed`,
            'info'
          );
        }

        isTestingRunning = false;
        document.getElementById('runAllBtn').disabled = false;
        document.getElementById('stopBtn').disabled = true;
      }

      async function runQuickTests() {
        if (isTestingRunning) return;

        // Run only core tests for quick verification
        const quickTests = testSuite.core.slice(0, 5);

        isTestingRunning = true;
        currentTest = 0;
        passedCount = 0;
        failedCount = 0;
        startTime = Date.now();

        log('‚ö° Running quick test suite...', 'info');

        for (const test of quickTests) {
          if (!isTestingRunning) break;
          test.category = 'core';
          await runTest(test);
        }

        log('‚ö° Quick tests completed!', 'success');
        isTestingRunning = false;
      }

      async function runCategoryTest(category) {
        if (isTestingRunning) return;

        const tests = testSuite[category];
        if (!tests) return;

        isTestingRunning = true;
        currentTest = 0;
        passedCount = 0;
        failedCount = 0;
        startTime = Date.now();

        log(`üéØ Running ${category} tests...`, 'info');

        for (const test of tests) {
          if (!isTestingRunning) break;
          test.category = category;
          await runTest(test);
        }

        log(`üéØ ${category} tests completed!`, 'success');
        isTestingRunning = false;
      }

      function stopAllTests() {
        isTestingRunning = false;
        log('‚èπÔ∏è Testing stopped by user', 'warning');
        document.getElementById('runAllBtn').disabled = false;
        document.getElementById('stopBtn').disabled = true;
      }

      function generateReport() {
        const report = {
          timestamp: new Date().toISOString(),
          totalTests: totalTestCount,
          testResults: testResults,
          summary: {
            passed: passedCount,
            failed: failedCount,
            successRate:
              Math.round((passedCount / (passedCount + failedCount)) * 100) ||
              0,
          },
        };

        const reportJson = JSON.stringify(report, null, 2);
        const blob = new Blob([reportJson], { type: 'application/json' });
        const url = URL.createObjectURL(blob);

        const a = document.createElement('a');
        a.href = url;
        a.download = `test-report-${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        log('üìÑ Test report generated and downloaded', 'success');
      }

      // Initialize on page load
      document.addEventListener('DOMContentLoaded', () => {
        initializeTestSuite();
        log(
          'üß™ Test suite ready - Click "Run All Tests" to begin comprehensive testing'
        );
      });
    </script>
  </body>
</html>
