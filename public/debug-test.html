<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ğŸ” Simple Debug Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background: #1a1a1a;
        color: white;
        padding: 20px;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background: #2d2d2d;
        padding: 20px;
        border-radius: 10px;
      }
      button {
        background: #4caf50;
        color: white;
        border: none;
        padding: 15px 25px;
        margin: 10px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
      }
      button:hover {
        background: #45a049;
      }
      .log {
        background: #000;
        color: #0f0;
        padding: 15px;
        border-radius: 5px;
        font-family: monospace;
        height: 400px;
        overflow-y: auto;
        margin-top: 20px;
      }
      .error {
        color: #ff4444;
      }
      .success {
        color: #44ff44;
      }
      .info {
        color: #4444ff;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ” Simple Debug Test</h1>
      <p>Let's debug why the tests aren't running...</p>

      <button onclick="testBasics()">ğŸ§ª Test Basics</button>
      <button onclick="testFirebase()">ğŸ”¥ Test Firebase</button>
      <button onclick="testModules()">ğŸ“¦ Test Modules</button>
      <button onclick="clearLog()">ğŸ—‘ï¸ Clear Log</button>

      <div id="log" class="log">
        <div class="info">
          ğŸ® Debug test ready. Click a button to start testing...
        </div>
      </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>

    <script>
      function log(message, type = 'info') {
        const logDiv = document.getElementById('log');
        const timestamp = new Date().toLocaleTimeString();
        const className = type;

        logDiv.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
        logDiv.scrollTop = logDiv.scrollHeight;

        // Also console log
        console.log(`[${timestamp}] ${message}`);
      }

      function clearLog() {
        document.getElementById('log').innerHTML =
          '<div class="info">Log cleared.</div>';
      }

      function testBasics() {
        log('ğŸ§ª Testing basic functionality...', 'info');

        try {
          // Test DOM
          log('âœ… DOM access working', 'success');

          // Test console
          log('âœ… Console logging working', 'success');

          // Test JavaScript basics
          const testArray = [1, 2, 3];
          const testPromise = Promise.resolve('test');
          log('âœ… JavaScript basics working', 'success');

          // Test modern features
          const testAsync = async () => 'async works';
          log('âœ… Modern JavaScript features working', 'success');

          log('ğŸ‰ All basic tests passed!', 'success');
        } catch (error) {
          log(`âŒ Basic test failed: ${error.message}`, 'error');
        }
      }

      function testFirebase() {
        log('ğŸ”¥ Testing Firebase SDK...', 'info');

        try {
          // Check if Firebase is loaded
          if (typeof firebase === 'undefined') {
            log('âŒ Firebase SDK not loaded!', 'error');
            return;
          }

          log('âœ… Firebase SDK loaded successfully', 'success');
          log(
            `ğŸ“¦ Firebase version: ${firebase.SDK_VERSION || 'Unknown'}`,
            'info'
          );

          // Test Firebase config
          const config = {
            apiKey: 'demo-key',
            authDomain: 'demo.firebaseapp.com',
            projectId: 'ball-network-demo',
            storageBucket: 'ball-network-demo.appspot.com',
            messagingSenderId: '123456789',
            appId: '1:123456789:web:demo',
          };

          log('ğŸ”§ Attempting Firebase initialization...', 'info');

          // Try safe initialization
          let app;
          try {
            app = firebase.initializeApp(config, 'debug-test-' + Date.now());
            log('âœ… Firebase app initialized successfully', 'success');
            log(`ğŸ“± App name: ${app.name}`, 'info');
          } catch (error) {
            if (error.code === 'app/duplicate-app') {
              log('âš ï¸ App already exists (this is expected)', 'info');
              app = firebase.app();
            } else {
              throw error;
            }
          }

          // Test services
          try {
            const auth = firebase.auth();
            log('âœ… Firebase Auth service available', 'success');
          } catch (error) {
            log(`âŒ Firebase Auth failed: ${error.message}`, 'error');
          }

          try {
            const firestore = firebase.firestore();
            log('âœ… Firebase Firestore service available', 'success');
          } catch (error) {
            log(`âŒ Firebase Firestore failed: ${error.message}`, 'error');
          }

          try {
            const storage = firebase.storage();
            log('âœ… Firebase Storage service available', 'success');
          } catch (error) {
            log(`âŒ Firebase Storage failed: ${error.message}`, 'error');
          }

          log('ğŸ‰ Firebase tests completed!', 'success');
        } catch (error) {
          log(`âŒ Firebase test failed: ${error.message}`, 'error');
          log(`ğŸ“‹ Error details: ${error.stack}`, 'error');
        }
      }

      async function testModules() {
        log('ğŸ“¦ Testing module loading...', 'info');

        try {
          // Test if modules can be loaded
          log('ğŸ” Checking for firebase-utils...', 'info');

          try {
            await import('./assets/js/firebase-utils.js');
            log('âœ… firebase-utils.js loaded successfully', 'success');
          } catch (error) {
            log(
              `âŒ firebase-utils.js failed to load: ${error.message}`,
              'error'
            );
          }

          log('ğŸ” Checking for firebaseConfig-demo...', 'info');

          try {
            await import('./assets/js/firebaseConfig-demo.js');
            log('âœ… firebaseConfig-demo.js loaded successfully', 'success');
          } catch (error) {
            log(
              `âŒ firebaseConfig-demo.js failed to load: ${error.message}`,
              'error'
            );
          }

          log('ğŸ” Checking for videoProcessor-demo...', 'info');

          try {
            await import('./assets/js/videoProcessor-demo.js');
            log('âœ… videoProcessor-demo.js loaded successfully', 'success');
          } catch (error) {
            log(
              `âŒ videoProcessor-demo.js failed to load: ${error.message}`,
              'error'
            );
          }

          log('ğŸ‰ Module tests completed!', 'success');
        } catch (error) {
          log(`âŒ Module test failed: ${error.message}`, 'error');
          log(`ğŸ“‹ Error details: ${error.stack}`, 'error');
        }
      }

      // Auto-run basic test on load
      document.addEventListener('DOMContentLoaded', function () {
        log('ğŸ® Simple Debug Test loaded', 'success');
        log('ğŸ‘† Click a test button to start debugging', 'info');
      });

      // Catch any uncaught errors
      window.addEventListener('error', function (event) {
        log(`ğŸš¨ Uncaught error: ${event.message}`, 'error');
        log(`ğŸ“ File: ${event.filename}:${event.lineno}`, 'error');
      });
    </script>
  </body>
</html>
