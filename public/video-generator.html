<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üé• Video Test Generator - 3 Ball Network</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }
      .container {
        background: white;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      }
      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
      }
      .generator-section {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
      }
      .button {
        background: #007bff;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        font-size: 16px;
        cursor: pointer;
        margin: 10px 5px;
        transition: background 0.3s;
      }
      .button:hover {
        background: #0056b3;
      }
      .button.success {
        background: #28a745;
      }
      canvas {
        border: 2px solid #ddd;
        border-radius: 8px;
        display: block;
        margin: 20px auto;
      }
      .instructions {
        background: #e3f2fd;
        border: 1px solid #2196f3;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
      }
      .test-links {
        text-align: center;
        margin: 30px 0;
      }
      .test-links a {
        display: inline-block;
        background: #17a2b8;
        color: white;
        text-decoration: none;
        padding: 12px 24px;
        border-radius: 6px;
        margin: 5px;
        transition: background 0.3s;
      }
      .test-links a:hover {
        background: #138496;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üé• Video Test Generator</h1>
      <p style="text-align: center; color: #666">
        Generate test videos or use sample videos to test the 3 Ball Network
        video functionality
      </p>

      <!-- Canvas Video Generator -->
      <div class="generator-section">
        <h3>üìπ Generate Test Video</h3>
        <p>
          Create a simple animated test video using HTML5 Canvas and
          MediaRecorder API:
        </p>
        <canvas id="videoCanvas" width="640" height="360"></canvas>
        <div style="text-align: center">
          <button class="button" onclick="generateTestVideo()">
            Generate Basketball Test Video
          </button>
          <button
            class="button"
            id="downloadBtn"
            style="display: none"
            onclick="downloadVideo()"
          >
            Download Generated Video
          </button>
        </div>
        <div
          id="generatorStatus"
          style="margin-top: 15px; text-align: center"
        ></div>
      </div>

      <!-- Instructions -->
      <div class="instructions">
        <h3>üìã How to Test Video Functionality</h3>
        <ol>
          <li>
            <strong>Generate a test video</strong> using the generator above, or
          </li>
          <li>
            <strong>Use your own video file</strong> (MP4, MOV, AVI, WebM
            format)
          </li>
          <li><strong>Open one of the test pages</strong> below</li>
          <li>
            <strong>Upload the video</strong> using drag & drop or file
            selection
          </li>
          <li>
            <strong>Test features</strong> like thumbnail generation, player
            controls, and clip creation
          </li>
        </ol>
      </div>

      <!-- Sample Video URLs -->
      <div class="generator-section">
        <h3>üåê Sample Video Sources</h3>
        <p>You can also test with these online sample videos:</p>
        <ul>
          <li>
            <a
              href="https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4"
              target="_blank"
              >Sample 720p Video (1MB)</a
            >
          </li>
          <li>
            <a
              href="https://filesamples.com/samples/video/mp4/SampleVideo_640x360_1mb.mp4"
              target="_blank"
              >Sample 360p Video (1MB)</a
            >
          </li>
          <li>
            <strong>Tip:</strong> Right-click and "Save As" to download these
            for testing
          </li>
        </ul>
      </div>

      <!-- Test Page Links -->
      <div class="test-links">
        <h3>üß™ Video Test Pages</h3>
        <a href="/video-live-test.html" target="_blank">üé¨ Live Video Test</a>
        <a href="/video-test.html" target="_blank">üîß Basic Video Test</a>
        <a href="/player.html" target="_blank">üèÄ Player Portal</a>
      </div>

      <!-- Test Results -->
      <div class="generator-section">
        <h3>üìä Test Results</h3>
        <div
          id="testResults"
          style="
            font-family: monospace;
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            min-height: 100px;
          "
        >
          Ready to generate test videos...
        </div>
      </div>
    </div>

    <script>
      let mediaRecorder;
      let recordedChunks = [];
      let generatedVideoBlob = null;

      function log(message) {
        const results = document.getElementById('testResults');
        const timestamp = new Date().toLocaleTimeString();
        results.textContent += `[${timestamp}] ${message}\n`;
        results.scrollTop = results.scrollHeight;
      }

      function updateStatus(message) {
        document.getElementById('generatorStatus').innerHTML = message;
      }

      async function generateTestVideo() {
        const canvas = document.getElementById('videoCanvas');
        const ctx = canvas.getContext('2d');
        const downloadBtn = document.getElementById('downloadBtn');

        try {
          log('üé¨ Starting video generation...');
          updateStatus('üé¨ Generating basketball test video...');

          // Set up media recorder
          const stream = canvas.captureStream(30); // 30 FPS
          mediaRecorder = new MediaRecorder(stream, {
            mimeType: 'video/webm;codecs=vp9',
          });

          recordedChunks = [];

          mediaRecorder.ondataavailable = event => {
            if (event.data.size > 0) {
              recordedChunks.push(event.data);
            }
          };

          mediaRecorder.onstop = () => {
            generatedVideoBlob = new Blob(recordedChunks, {
              type: 'video/webm',
            });

            log('‚úÖ Video generation complete!');
            log(
              `üìÅ Generated video size: ${(generatedVideoBlob.size / 1024 / 1024).toFixed(2)} MB`
            );
            updateStatus(
              '‚úÖ Video generated successfully! Click download to save.'
            );
            downloadBtn.style.display = 'inline-block';
          };

          // Start recording
          mediaRecorder.start();
          log('üî¥ Recording started...');

          // Animate basketball scene
          let frame = 0;
          const totalFrames = 150; // 5 seconds at 30fps

          function drawFrame() {
            // Clear canvas
            ctx.fillStyle = '#4a5568';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw basketball court
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;

            // Court outline
            ctx.strokeRect(50, 50, canvas.width - 100, canvas.height - 100);

            // Center circle
            ctx.beginPath();
            ctx.arc(canvas.width / 2, canvas.height / 2, 50, 0, Math.PI * 2);
            ctx.stroke();

            // Free throw circles
            ctx.beginPath();
            ctx.arc(120, canvas.height / 2, 40, 0, Math.PI * 2);
            ctx.stroke();

            ctx.beginPath();
            ctx.arc(canvas.width - 120, canvas.height / 2, 40, 0, Math.PI * 2);
            ctx.stroke();

            // Animated basketball
            const ballX = 100 + (frame / totalFrames) * (canvas.width - 200);
            const ballY = canvas.height / 2 + Math.sin(frame * 0.3) * 50;

            // Ball shadow
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.beginPath();
            ctx.ellipse(ballX, canvas.height - 70, 15, 5, 0, 0, Math.PI * 2);
            ctx.fill();

            // Basketball
            ctx.fillStyle = '#ff6b35';
            ctx.beginPath();
            ctx.arc(ballX, ballY, 20, 0, Math.PI * 2);
            ctx.fill();

            // Basketball lines
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(ballX, ballY, 20, 0, Math.PI * 2);
            ctx.stroke();

            // Vertical line
            ctx.beginPath();
            ctx.moveTo(ballX, ballY - 20);
            ctx.lineTo(ballX, ballY + 20);
            ctx.stroke();

            // Horizontal line
            ctx.beginPath();
            ctx.moveTo(ballX - 20, ballY);
            ctx.lineTo(ballX + 20, ballY);
            ctx.stroke();

            // Title text
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 24px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('3 Ball Network - Test Video', canvas.width / 2, 40);

            // Frame counter
            ctx.font = '16px Arial';
            ctx.textAlign = 'right';
            ctx.fillText(
              `Frame: ${frame}/${totalFrames}`,
              canvas.width - 20,
              canvas.height - 20
            );

            frame++;

            if (frame < totalFrames) {
              requestAnimationFrame(drawFrame);
            } else {
              // Stop recording
              mediaRecorder.stop();
              log('‚èπÔ∏è Recording stopped');
            }
          }

          // Start animation
          drawFrame();
        } catch (error) {
          log('‚ùå Error generating video: ' + error.message);
          updateStatus('‚ùå Error generating video');
          console.error('Video generation error:', error);
        }
      }

      function downloadVideo() {
        if (!generatedVideoBlob) {
          log('‚ùå No video to download');
          return;
        }

        const url = URL.createObjectURL(generatedVideoBlob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'basketball-test-video.webm';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        log('üíæ Video download started');
        log('üìÅ File: basketball-test-video.webm');
        log('üí° You can now use this video to test the upload functionality!');
      }

      // Initialize
      log('üöÄ Video test generator ready');
      log('üí° Click "Generate Basketball Test Video" to create a test video');
      log('üì± Then use the generated video to test the upload functionality');
    </script>
  </body>
</html>
