<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video Functionality Test - 3 Ball Network</title>
    <link rel="stylesheet" href="/assets/css/video-components.css" />
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #f5f5f5;
      }
      .test-container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .test-header {
        text-align: center;
        margin-bottom: 30px;
      }
      .status-indicator {
        padding: 10px;
        border-radius: 4px;
        margin: 10px 0;
      }
      .status-loading {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        color: #856404;
      }
      .status-success {
        background: #d4edda;
        border: 1px solid #c3e6cb;
        color: #155724;
      }
      .status-error {
        background: #f8d7da;
        border: 1px solid #f5c6cb;
        color: #721c24;
      }
    </style>
  </head>
  <body>
    <div class="test-container">
      <div class="test-header">
        <h1>ğŸ¬ Video Functionality Test</h1>
        <p>Testing video upload, processing, and playback features</p>
      </div>

      <!-- Status indicators -->
      <div id="statusIndicators">
        <div class="status-indicator status-loading" id="statusFirebase">
          ğŸ”¥ Initializing Firebase connection...
        </div>
        <div class="status-indicator status-loading" id="statusVideoProcessor">
          ğŸ¬ Loading Video Processor...
        </div>
        <div class="status-indicator status-loading" id="statusVideoGallery">
          ğŸ“± Loading Video Gallery...
        </div>
      </div>

      <!-- Test video gallery container -->
      <div id="videoGalleryContainer" style="margin-top: 30px">
        <!-- Video gallery will be initialized here -->
      </div>

      <!-- Test results -->
      <div id="testResults" style="margin-top: 30px">
        <h3>Test Results:</h3>
        <div
          id="consoleOutput"
          style="
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
          "
        >
          Console output will appear here...
        </div>
      </div>
    </div>

    <!-- Load Firebase and video modules -->
    <script type="module">
      // Capture console output for testing
      const originalLog = console.log;
      const originalError = console.error;
      const originalWarn = console.warn;
      const consoleOutput = document.getElementById('consoleOutput');

      function appendToConsole(type, message) {
        const timestamp = new Date().toLocaleTimeString();
        consoleOutput.textContent += `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
        consoleOutput.scrollTop = consoleOutput.scrollHeight;
      }

      console.log = function (...args) {
        appendToConsole('log', args.join(' '));
        originalLog.apply(console, args);
      };

      console.error = function (...args) {
        appendToConsole('error', args.join(' '));
        originalError.apply(console, args);
      };

      console.warn = function (...args) {
        appendToConsole('warn', args.join(' '));
        originalWarn.apply(console, args);
      };

      // Test Firebase connection
      try {
        import('./assets/js/firebaseConfig-demo.js')
          .then(() => {
            document.getElementById('statusFirebase').className =
              'status-indicator status-success';
            document.getElementById('statusFirebase').innerHTML =
              'ğŸ”¥ Firebase connection: SUCCESS (Demo Mode)';
            console.log('âœ… Demo Firebase config loaded successfully');
          })
          .catch(error => {
            // Fallback to try original config
            console.log('ğŸ”„ Trying original Firebase config...');
            return import('./assets/js/firebaseConfig.js');
          })
          .then(() => {
            if (
              document
                .getElementById('statusFirebase')
                .innerHTML.includes('Demo Mode')
            ) {
              return; // Already set
            }
            document.getElementById('statusFirebase').className =
              'status-indicator status-success';
            document.getElementById('statusFirebase').innerHTML =
              'ğŸ”¥ Firebase connection: SUCCESS';
            console.log('âœ… Firebase config loaded successfully');
          })
          .catch(error => {
            document.getElementById('statusFirebase').className =
              'status-indicator status-error';
            document.getElementById('statusFirebase').innerHTML =
              'ğŸ”¥ Firebase connection: ERROR - ' + error.message;
            console.error('âŒ Firebase config error:', error);
          });
      } catch (error) {
        console.error('âŒ Error loading Firebase:', error);
      }

      // Test Video Processor
      try {
        import('./assets/js/videoProcessor-demo.js')
          .then(module => {
            document.getElementById('statusVideoProcessor').className =
              'status-indicator status-success';
            document.getElementById('statusVideoProcessor').innerHTML =
              'ğŸ¬ Video Processor: SUCCESS (Demo Mode)';
            console.log('âœ… Demo Video Processor loaded successfully');

            // Test if VideoProcessor is available globally
            setTimeout(() => {
              if (window.videoProcessor) {
                console.log(
                  'âœ… Demo Video Processor instance available globally'
                );
              } else {
                console.warn(
                  'âš ï¸ Demo Video Processor instance not found globally'
                );
              }
            }, 1000);
          })
          .catch(error => {
            // Fallback to original
            return import('./assets/js/videoProcessor.js');
          })
          .then(module => {
            if (
              document
                .getElementById('statusVideoProcessor')
                .innerHTML.includes('Demo Mode')
            ) {
              return; // Already set
            }
            document.getElementById('statusVideoProcessor').className =
              'status-indicator status-success';
            document.getElementById('statusVideoProcessor').innerHTML =
              'ğŸ¬ Video Processor: SUCCESS';
            console.log('âœ… Video Processor loaded successfully');
          })
          .catch(error => {
            document.getElementById('statusVideoProcessor').className =
              'status-indicator status-error';
            document.getElementById('statusVideoProcessor').innerHTML =
              'ğŸ¬ Video Processor: ERROR - ' + error.message;
            console.error('âŒ Video Processor error:', error);
          });
      } catch (error) {
        console.error('âŒ Error loading Video Processor:', error);
      }

      // Test Video Gallery
      try {
        import('./assets/js/videoGallery.js')
          .then(module => {
            document.getElementById('statusVideoGallery').className =
              'status-indicator status-success';
            document.getElementById('statusVideoGallery').innerHTML =
              'ğŸ“± Video Gallery: SUCCESS';
            console.log('âœ… Video Gallery loaded successfully');

            // Test if VideoGallery initializes properly
            setTimeout(() => {
              if (window.videoGallery) {
                console.log('âœ… Video Gallery instance available globally');
                console.log('âœ… Video Gallery initialized with container');
              } else {
                console.warn('âš ï¸ Video Gallery instance not found globally');
              }
            }, 1000);
          })
          .catch(error => {
            document.getElementById('statusVideoGallery').className =
              'status-indicator status-error';
            document.getElementById('statusVideoGallery').innerHTML =
              'ğŸ“± Video Gallery: ERROR - ' + error.message;
            console.error('âŒ Video Gallery error:', error);
          });
      } catch (error) {
        console.error('âŒ Error loading Video Gallery:', error);
      }

      // Set up a mock user ID for testing
      if (!localStorage.getItem('userId')) {
        localStorage.setItem('userId', 'test-user-' + Date.now());
        console.log('ğŸ”‘ Set up test user ID for demo');
      }

      console.log('ğŸš€ Video functionality test started');
    </script>
  </body>
</html>
