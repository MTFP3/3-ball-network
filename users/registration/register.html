<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Register - 3 Ball Network</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Google Fonts: Urbanist & Montserrat for a modern, energetic look -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Urbanist:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <style>
    body {
      font-family: 'Urbanist', 'Montserrat', Arial, sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #007cba 0%, #00b4d8 100%);
      color: #222;
      min-height: 100vh;
      overflow-x: hidden;
      letter-spacing: 0.02em;
    }
    .banner-logo {
      width: 100vw;
      background: #111;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 1.5em 0 1em 0;
      margin: 0;
    }
    .banner-logo-img {
      max-width: 320px;
      width: 90vw;
      height: auto;
      display: block;
      filter: drop-shadow(0 8px 32px rgba(0,0,0,0.18));
      border-radius: 24px;
      background: none;
      padding: 0.5em 1.5em;
      box-shadow: 0 2px 16px rgba(0,0,0,0.10);
      border: none;
    }
    @media (max-width: 700px) {
      .banner-logo-img { max-width: 90vw; padding: 0.5em; }
      .banner-logo { padding: 1em 0 0.5em 0; }
    }
    header {
      background: transparent;
      text-align: center;
      padding: 3em 1em 1.5em 1em;
      position: relative;
    }
    .site-title {
      font-family: 'Montserrat', 'Urbanist', Arial, sans-serif;
      font-size: 3em;
      font-weight: 900;
      letter-spacing: 3px;
      color: #fff;
      margin: 0.2em 0 0.1em 0;
      text-shadow: 0 6px 24px rgba(0,0,0,0.18);
      text-transform: uppercase;
    }
    .site-tagline {
      font-family: 'Urbanist', Arial, sans-serif;
      color: #e0fbfc;
      font-size: 1.35em;
      margin-bottom: 0.7em;
      letter-spacing: 1.5px;
      font-weight: 700;
      text-shadow: 0 2px 8px rgba(0,0,0,0.10);
    }
    nav {
      background: rgba(255,255,255,0.98);
      padding: 1.1em 0;
      box-shadow: 0 2px 12px rgba(0,0,0,0.04);
      text-align: center;
      border-radius: 0 0 22px 22px;
      margin: 0 auto 2em auto;
      max-width: 720px;
      font-size: 1.18em;
      font-family: 'Montserrat', Arial, sans-serif;
    }
    nav a {
      margin: 0 1.5em;
      color: #007cba;
      text-decoration: none;
      font-weight: 900;
      letter-spacing: 0.5px;
      transition: color 0.2s;
      position: relative;
      text-transform: uppercase;
    }
    nav a::after {
      content: "";
      display: block;
      width: 0;
      height: 2.5px;
      background: linear-gradient(90deg, #00b4d8 0%, #007cba 100%);
      transition: width 0.3s;
      margin: 0 auto;
      border-radius: 2px;
    }
    nav a:hover {
      color: #00b4d8;
    }
    nav a:hover::after {
      width: 100%;
    }
    .register-hero {
      max-width: 750px;
      margin: 2.5em auto 2em auto;
      background: rgba(255,255,255,0.99);
      border-radius: 28px;
      box-shadow: 0 8px 36px rgba(0,0,0,0.16);
      padding: 3em 2em 2.5em 2em;
      text-align: center;
      position: relative;
      overflow: hidden;
      font-family: 'Urbanist', Arial, sans-serif;
      animation: fadeInUp 0.9s cubic-bezier(.4,0,.2,1);
    }
    .register-hero h2 {
      font-size: 2.1em;
      margin-bottom: 0.5em;
      color: #007cba;
      font-weight: 900;
      letter-spacing: 1.5px;
      font-family: 'Montserrat', Arial, sans-serif;
      text-transform: uppercase;
    }
    .register-hero p {
      font-size: 1.18em;
      color: #444;
      margin-bottom: 2em;
      font-family: 'Urbanist', Arial, sans-serif;
    }
    form {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 1em;
      background: none;
    }
    label {
      font-family: 'Montserrat', Arial, sans-serif;
      font-weight: 700;
      color: #007cba;
      margin-bottom: 0.2em;
      margin-top: 0.5em;
      font-size: 1em;
      text-align: left;
    }
    input, select {
      width: 100%;
      padding: 0.7em 1em;
      border: 1.5px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1em;
      font-family: 'Urbanist', Arial, sans-serif;
      background: #f9f9f9;
      margin-bottom: 0.2em;
      transition: border 0.2s;
    }
    input:focus, select:focus {
      border-color: #007cba;
      outline: none;
      background: #fff;
    }
    button[type="submit"] {
      background: #007cba;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 1em;
      font-family: 'Montserrat', Arial, sans-serif;
      font-weight: 900;
      font-size: 1.1em;
      letter-spacing: 1px;
      cursor: pointer;
      margin-top: 1em;
      transition: background 0.2s;
    }
    button[type="submit"]:hover {
      background: #00b4d8;
    }
    .login-link {
      margin-top: 1.5em;
      text-align: center;
      color: #444;
      font-size: 1em;
    }
    .login-link a {
      color: #007cba;
      text-decoration: none;
      font-weight: 700;
    }
    .login-link a:hover {
      text-decoration: underline;
    }
    .register-loading {
      text-align: center;
      color: #007cba;
      font-weight: 700;
      margin-top: 0.5em;
      display: none;
    }
    .reg-error {
      color: #d90429;
      font-weight: 700;
      text-align: center;
      margin-top: 0.5em;
      display: none;
    }
    .reg-success {
      color: #009e60;
      font-weight: 700;
      text-align: center;
      margin-top: 0.5em;
      display: none;
    }
    .password-container {
      display: flex;
      align-items: center;
      gap: 0.5em;
    }
    .password-container input {
      flex: 1;
      margin-bottom: 0;
    }
    .password-container button {
      background: #e0e0e0;
      border: none;
      border-radius: 6px;
      padding: 0.5em 1em;
      font-size: 0.95em;
      cursor: pointer;
      color: #007cba;
      font-family: 'Montserrat', Arial, sans-serif;
      font-weight: 700;
      transition: background 0.2s;
    }
    .password-container button:hover {
      background: #b2e0f7;
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px);}
      to { opacity: 1; transform: translateY(0);}
    }
    @media (max-width: 700px) {
      .register-hero { max-width: 98vw; padding: 1em; }
      .site-title { font-size: 2em; }
    }
  </style>
</head>
<body>
  <div class="banner-logo">
    <img src="../../Media/logo.png" alt="3 Ball Network Logo" class="banner-logo-img">
  </div>
  <header>
    <div class="site-title">3 Ball Network</div>
    <div class="site-tagline">Connecting Players, Coaches, Scouts, and Fans</div>
  </header>
  <nav>
    <a href="/">Home</a>
    <a href="/users/registration/">Register</a>
    <a href="/users/login.html">Login</a>
  </nav>
  <div class="register-hero">
    <h2>Register</h2>
    <p>Join the 3 Ball Network and connect with players, coaches, scouts, and fans!</p>
    <!-- Role Selector Modal -->
    <div id="role-modal" style="display:block;">
      <button type="button" onclick="selectRole('Player')">Player</button>
      <button type="button" onclick="selectRole('Coach')">Coach</button>
      <button type="button" onclick="selectRole('Scout')">Scout</button>
      <button type="button" onclick="selectRole('Fan')">Fan</button>
    </div>
    <!-- Gender Selector Modal (hidden by default) -->
    <div id="gender-modal" style="display:none;">
      <button type="button" onclick="selectGender('Male')">Male</button>
      <button type="button" onclick="selectGender('Female')">Female</button>
    </div>
    <!-- Registration Forms -->
    <!-- Player Male -->
    <div id="player-male-form" style="display:none;">
      <form id="form-player-male" autocomplete="off" enctype="multipart/form-data">
        <input type="hidden" name="gender" value="male">
        <label for="email-player-male">Email</label>
        <input type="email" id="email-player-male" name="email" required autocomplete="username">
        <label for="password-player-male">Create Password</label>
        <span class="password-container">
          <input type="password" id="password-player-male" name="password" required pattern="(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}" title="At least 8 characters, 1 uppercase, 1 lowercase, 1 number">
          <button type="button" class="toggle-password">Show</button>
        </span>
        <label for="confirm-password-player-male">Confirm Password</label>
        <span class="password-container">
          <input type="password" id="confirm-password-player-male" name="confirmPassword" required>
          <button type="button" class="toggle-password">Show</button>
        </span>
        <label for="photo-player-male">Profile Photo</label>
        <input type="file" id="photo-player-male" name="photo" accept="image/*" required>
        <label for="first-player-male">First Name</label>
        <input type="text" id="first-player-male" name="first" required>
        <label for="last-player-male">Last Name</label>
        <input type="text" id="last-player-male" name="last" required>
        <label for="state-player-male">State</label>
        <select id="state-player-male" name="state" required>
          <option value="">Select State</option>
          <!-- ...state options... -->
          <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option>
          <option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option>
          <option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option>
          <option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option>
          <option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option>
          <option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option>
          <option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option>
          <option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option>
          <option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option>
          <option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option>
          <option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option>
          <option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option>
          <option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option>
          <option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option>
          <option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option>
          <option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option>
          <option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
        </select>
        <label for="city-player-male">City</label>
        <input type="text" id="city-player-male" name="city" required placeholder="Enter your city">
        <label for="school-player-male">School</label>
        <input type="text" id="school-player-male" name="school" required placeholder="Enter your school">
        <label for="team-player-male">Team</label>
        <input type="text" id="team-player-male" name="team" placeholder="Enter Team ID or Name">
        <label for="phone-player-male">Phone Number</label>
        <input type="tel" id="phone-player-male" name="phone" required pattern="[0-9]{10,}">
        <!-- Player Male Positions (accessible) -->
        <label>Position(s)</label>
        <div style="display:flex;gap:1em;justify-content:center;margin-bottom:1em;">
          <input type="checkbox" id="position-guard-player-male" name="position" value="guard">
          <label for="position-guard-player-male" style="margin-bottom:0;">Guard</label>
          <input type="checkbox" id="position-forward-player-male" name="position" value="forward">
          <label for="position-forward-player-male" style="margin-bottom:0;">Forward</label>
          <input type="checkbox" id="position-center-player-male" name="position" value="center">
          <label for="position-center-player-male" style="margin-bottom:0;">Center</label>
        </div>
        <label>Height</label>
        <div style="display:flex;gap:0.5em;">
          <input type="number" id="heightFt-player-male" name="heightFt" min="4" max="7" placeholder="Feet" required style="flex:1;">
          <input type="number" id="heightIn-player-male" name="heightIn" min="0" max="11" placeholder="Inches" required style="flex:1;">
        </div>
        <label for="weight-player-male">Weight (lbs)</label>
        <input type="number" id="weight-player-male" name="weight" min="80" max="400" required>
        <button type="submit">Register</button>
        <div class="register-loading">Loading...</div>
        <div class="reg-error"></div>
        <div class="reg-success"></div>
      </form>
    </div>
    <!-- Player Female -->
    <div id="player-female-form" style="display:none;">
      <form id="form-player-female" autocomplete="off" enctype="multipart/form-data">
        <input type="hidden" name="gender" value="female">
        <label for="email-player-female">Email</label>
        <input type="email" id="email-player-female" name="email" required autocomplete="username">
        <label for="password-player-female">Create Password</label>
        <span class="password-container">
          <input type="password" id="password-player-female" name="password" required pattern="(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}" title="At least 8 characters, 1 uppercase, 1 lowercase, 1 number">
          <button type="button" class="toggle-password">Show</button>
        </span>
        <label for="confirm-password-player-female">Confirm Password</label>
        <span class="password-container">
          <input type="password" id="confirm-password-player-female" name="confirmPassword" required>
          <button type="button" class="toggle-password">Show</button>
        </span>
        <label for="photo-player-female">Profile Photo</label>
        <input type="file" id="photo-player-female" name="photo" accept="image/*" required>
        <label for="first-player-female">First Name</label>
        <input type="text" id="first-player-female" name="first" required>
        <label for="last-player-female">Last Name</label>
        <input type="text" id="last-player-female" name="last" required>
        <label for="state-player-female">State</label>
        <select id="state-player-female" name="state" required>
          <option value="">Select State</option>
          <!-- ...state options as above... -->
          <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option>
          <option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option>
          <option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option>
          <option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option>
          <option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option>
          <option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option>
          <option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option>
          <option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option>
          <option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option>
          <option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option>
          <option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option>
          <option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option>
          <option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option>
          <option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option>
          <option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option>
          <option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option>
          <option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
        </select>
        <label for="city-player-female">City</label>
        <input type="text" id="city-player-female" name="city" required placeholder="Enter your city">
        <label for="school-player-female">School</label>
        <input type="text" id="school-player-female" name="school" required placeholder="Enter your school">
        <label for="team-player-female">Team</label>
        <input type="text" id="team-player-female" name="team" placeholder="Enter Team ID or Name">
        <label for="phone-player-female">Phone Number</label>
        <input type="tel" id="phone-player-female" name="phone" required pattern="[0-9]{10,}">
        <!-- Player Female Positions (accessible) -->
        <label>Position(s)</label>
        <div style="display:flex;gap:1em;justify-content:center;margin-bottom:1em;">
          <input type="checkbox" id="position-guard-player-female" name="position" value="guard">
          <label for="position-guard-player-female" style="margin-bottom:0;">Guard</label>
          <input type="checkbox" id="position-forward-player-female" name="position" value="forward">
          <label for="position-forward-player-female" style="margin-bottom:0;">Forward</label>
          <input type="checkbox" id="position-center-player-female" name="position" value="center">
          <label for="position-center-player-female" style="margin-bottom:0;">Center</label>
        </div>
        <label>Height</label>
        <div style="display:flex;gap:0.5em;">
          <input type="number" id="heightFt-player-female" name="heightFt" min="4" max="7" placeholder="Feet" required style="flex:1;">
          <input type="number" id="heightIn-player-female" name="heightIn" min="0" max="11" placeholder="Inches" required style="flex:1;">
        </div>
        <label for="weight-player-female">Weight (lbs)</label>
        <input type="number" id="weight-player-female" name="weight" min="80" max="400" required>
        <button type="submit">Register</button>
        <div class="register-loading">Loading...</div>
        <div class="reg-error"></div>
        <div class="reg-success"></div>
      </form>
    </div>
    <!-- Coach -->
    <div id="coach-form" style="display:none;">
      <form id="form-coach" autocomplete="off" enctype="multipart/form-data">
        <label for="email-coach">Email</label>
        <input type="email" id="email-coach" name="email" required autocomplete="username">
        <label for="password-coach">Create Password</label>
        <span class="password-container">
          <input type="password" id="password-coach" name="password" required pattern="(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}" title="At least 8 characters, 1 uppercase, 1 lowercase, 1 number">
          <button type="button" class="toggle-password">Show</button>
        </span>
        <label for="confirm-password-coach">Confirm Password</label>
        <span class="password-container">
          <input type="password" id="confirm-password-coach" name="confirmPassword" required>
          <button type="button" class="toggle-password">Show</button>
        </span>
        <label for="photo-coach">Profile Photo</label>
        <input type="file" id="photo-coach" name="photo" accept="image/*" required>
        <label for="first-coach">First Name</label>
        <input type="text" id="first-coach" name="first" required>
        <label for="last-coach">Last Name</label>
        <input type="text" id="last-coach" name="last" required>
        <label for="state-coach">State</label>
        <select id="state-coach" name="state" required>
          <option value="">Select State</option>
          <!-- ...state options as above... -->
          <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option>
          <option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option>
          <option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option>
          <option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option>
          <option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option>
          <option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option>
          <option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option>
          <option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option>
          <option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option>
          <option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option>
          <option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option>
          <option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option>
          <option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option>
          <option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option>
          <option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option>
          <option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option>
          <option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
        </select>
        <label for="city-coach">City</label>
        <input type="text" id="city-coach" name="city" required placeholder="Enter your city">
        <label for="school-coach">School</label>
        <input type="text" id="school-coach" name="school" required placeholder="Enter your school">
        <label for="team-coach">Team</label>
        <input type="text" id="team-coach" name="team" placeholder="Enter Team ID or Name">
        <label for="phone-coach">Phone Number</label>
        <input type="tel" id="phone-coach" name="phone" required pattern="[0-9]{10,}">
        <!-- Coach Levels (accessible) -->
        <label>Level(s) Coached</label>
        <div style="display:flex;gap:1em;justify-content:center;margin-bottom:1em;">
          <input type="checkbox" id="level-ms-coach" name="level" value="Middle School">
          <label for="level-ms-coach" style="margin-bottom:0;">Middle School</label>
          <input type="checkbox" id="level-hs-coach" name="level" value="High School">
          <label for="level-hs-coach" style="margin-bottom:0;">High School</label>
          <input type="checkbox" id="level-aau-coach" name="level" value="AAU">
          <label for="level-aau-coach" style="margin-bottom:0;">AAU</label>
          <input type="checkbox" id="level-both-coach" name="level" value="Both">
          <label for="level-both-coach" style="margin-bottom:0;">Both</label>
        </div>
        <button type="submit">Register</button>
        <div class="register-loading">Loading...</div>
        <div class="reg-error"></div>
        <div class="reg-success"></div>
      </form>
    </div>
    <!-- Scout -->
    <div id="scout-form" style="display:none;">
      <form id="form-scout" autocomplete="off" enctype="multipart/form-data">
        <label for="email-scout">Email</label>
        <input type="email" id="email-scout" name="email" required autocomplete="username">
        <label for="password-scout">Create Password</label>
        <span class="password-container">
          <input type="password" id="password-scout" name="password" required pattern="(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}" title="At least 8 characters, 1 uppercase, 1 lowercase, 1 number">
          <button type="button" class="toggle-password">Show</button>
        </span>
        <label for="confirm-password-scout">Confirm Password</label>
        <span class="password-container">
          <input type="password" id="confirm-password-scout" name="confirmPassword" required>
          <button type="button" class="toggle-password">Show</button>
        </span>
        <label for="photo-scout">Profile Photo</label>
        <input type="file" id="photo-scout" name="photo" accept="image/*" required>
        <label for="first-scout">First Name</label>
        <input type="text" id="first-scout" name="first" required>
        <label for="last-scout">Last Name</label>
        <input type="text" id="last-scout" name="last" required>
        <label for="state-scout">State</label>
        <select id="state-scout" name="state" required>
          <option value="">Select State</option>
          <!-- ...state options as above... -->
          <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option>
          <option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option>
          <option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option>
          <option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option>
          <option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option>
          <option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option>
          <option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option>
          <option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option>
          <option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option>
          <option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option>
          <option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option>
          <option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option>
          <option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option>
          <option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option>
          <option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option>
          <option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option>
          <option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
        </select>
        <label for="city-scout">City</label>
        <input type="text" id="city-scout" name="city" required placeholder="Enter your city">
        <label for="phone-scout">Phone Number</label>
        <input type="tel" id="phone-scout" name="phone" required pattern="[0-9]{10,}">
        <button type="submit">Register</button>
        <div class="register-loading">Loading...</div>
        <div class="reg-error"></div>
        <div class="reg-success"></div>
      </form>
    </div>
    <!-- Fan -->
    <div id="fan-form" style="display:none;">
      <form id="form-fan" autocomplete="off" enctype="multipart/form-data">
        <label for="email-fan">Email</label>
        <input type="email" id="email-fan" name="email" required autocomplete="username">
        <label for="password-fan">Create Password</label>
        <span class="password-container">
          <input type="password" id="password-fan" name="password" required pattern="(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}" title="At least 8 characters, 1 uppercase, 1 lowercase, 1 number">
          <button type="button" class="toggle-password">Show</button>
        </span>
        <label for="confirm-password-fan">Confirm Password</label>
        <span class="password-container">
          <input type="password" id="confirm-password-fan" name="confirmPassword" required>
          <button type="button" class="toggle-password">Show</button>
        </span>
        <label for="photo-fan">Profile Photo</label>
        <input type="file" id="photo-fan" name="photo" accept="image/*" required>
        <label for="first-fan">First Name</label>
        <input type="text" id="first-fan" name="first" required>
        <label for="last-fan">Last Name</label>
        <input type="text" id="last-fan" name="last" required>
        <label for="state-fan">State</label>
        <select id="state-fan" name="state" required>
          <option value="">Select State</option>
          <!-- ...state options as above... -->
          <option value="AL">Alabama</option><option value="AK">Alaska</option><option value="AZ">Arizona</option>
          <option value="AR">Arkansas</option><option value="CA">California</option><option value="CO">Colorado</option>
          <option value="CT">Connecticut</option><option value="DE">Delaware</option><option value="FL">Florida</option>
          <option value="GA">Georgia</option><option value="HI">Hawaii</option><option value="ID">Idaho</option>
          <option value="IL">Illinois</option><option value="IN">Indiana</option><option value="IA">Iowa</option>
          <option value="KS">Kansas</option><option value="KY">Kentucky</option><option value="LA">Louisiana</option>
          <option value="ME">Maine</option><option value="MD">Maryland</option><option value="MA">Massachusetts</option>
          <option value="MI">Michigan</option><option value="MN">Minnesota</option><option value="MS">Mississippi</option>
          <option value="MO">Missouri</option><option value="MT">Montana</option><option value="NE">Nebraska</option>
          <option value="NV">Nevada</option><option value="NH">New Hampshire</option><option value="NJ">New Jersey</option>
          <option value="NM">New Mexico</option><option value="NY">New York</option><option value="NC">North Carolina</option>
          <option value="ND">North Dakota</option><option value="OH">Ohio</option><option value="OK">Oklahoma</option>
          <option value="OR">Oregon</option><option value="PA">Pennsylvania</option><option value="RI">Rhode Island</option>
          <option value="SC">South Carolina</option><option value="SD">South Dakota</option><option value="TN">Tennessee</option>
          <option value="TX">Texas</option><option value="UT">Utah</option><option value="VT">Vermont</option>
          <option value="VA">Virginia</option><option value="WA">Washington</option><option value="WV">West Virginia</option>
          <option value="WI">Wisconsin</option><option value="WY">Wyoming</option>
        </select>
        <label for="city-fan">City</label>
        <input type="text" id="city-fan" name="city" required placeholder="Enter your city">
        <label for="phone-fan">Phone Number</label>
        <input type="tel" id="phone-fan" name="phone" required pattern="[0-9]{10,}">
        <button type="submit">Register</button>
        <div class="register-loading">Loading...</div>
        <div class="reg-error"></div>
        <div class="reg-success"></div>
      </form>
    </div>
    <div class="login-link">
      Already have an account? <a href="../login.html">Login here</a>
    </div>
    <div class="legal-links" style="margin-top:1em; text-align:center; font-size:0.98em;">
      <a href="/privacy-policy.html" target="_blank" style="color:#007cba; text-decoration:none; margin-right:1.5em;">Privacy Policy</a>
      <a href="/terms-of-service.html" target="_blank" style="color:#007cba; text-decoration:none;">Terms of Service</a>
    </div>
  </div>
  <!-- Firebase App (the core Firebase SDK) -->
  <script type="module" src="/shared/firebase.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD4XJLc3_CLvOhvMsytQx2fabgZQt3y5g0",
      authDomain: "ball-network-web.firebaseapp.com",
      projectId: "ball-network-web",
      storageBucket: "ball-network-web.appspot.com",
      messagingSenderId: "749015998465",
      appId: "1:749015998465:web:59ac026f3f4c2ec5da3500",
      measurementId: "G-ZS07SKSRRL"
    };
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }

    function hideAllForms() {
      document.getElementById('player-male-form').style.display = 'none';
      document.getElementById('player-female-form').style.display = 'none';
      document.getElementById('coach-form').style.display = 'none';
      document.getElementById('scout-form').style.display = 'none';
      document.getElementById('fan-form').style.display = 'none';
    }
    function selectRole(role) {
      document.getElementById('role-modal').style.display = 'none';
      hideAllForms();
      if (role === 'Player') {
        document.getElementById('gender-modal').style.display = 'block';
      } else if (role === 'Coach') {
        document.getElementById('coach-form').style.display = 'block';
      } else if (role === 'Scout') {
        document.getElementById('scout-form'). style.display = 'block';
      } else if (role === 'Fan') {
        document.getElementById('fan-form').style.display = 'block';
      }
    }
    function selectGender(gender) {
      document.getElementById('gender-modal').style.display = 'none';
      hideAllForms();
      if (gender === 'Male') {
        document.getElementById('player-male-form').style.display = 'block';
      } else if (gender === 'Female') {
        document.getElementById('player-female-form').style.display = 'block';
      }
    }
    // Password show/hide for all forms
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelectorAll('.toggle-password').forEach(btn => {
        btn.addEventListener('click', function() {
          const input = this.parentElement.querySelector('input[type="password"],input[type="text"]');
          if (input.type === "password") {
            input.type = "text";
            this.textContent = "Hide";
          } else {
            input.type = "password";
            this.textContent = "Show";
          }
        });
      });

      document.querySelectorAll('form[id^="form-"]').forEach(form => {
        form.addEventListener('submit', async function(e) {
          e.preventDefault();
          const loading = form.querySelector('.register-loading');
          const errorDiv = form.querySelector('.reg-error');
          const successDiv = form.querySelector('.reg-success');
          loading.style.display = 'block';
          errorDiv.style.display = 'none';
          successDiv.style.display = 'none';
          errorDiv.textContent = '';
          successDiv.textContent = '';

          // Prevent duplicate submissions
          form.querySelector('button[type="submit"]').disabled = true;

          // Confirm password check
          const pwInput = form.querySelector('input[name="password"]');
          const confirmPwInput = form.querySelector('input[name="confirmPassword"]');
          if (pwInput && confirmPwInput && pwInput.value !== confirmPwInput.value) {
            loading.style.display = 'none';
            errorDiv.textContent = 'Passwords do not match.';
            errorDiv.style.display = 'block';
            form.querySelector('button[type="submit"]').disabled = false;
            pwInput.value = '';
            confirmPwInput.value = '';
            return;
          }

          // Validate at least one checkbox for positions/levels if present
          if (form.querySelectorAll('input[name="position"]').length) {
            const checked = form.querySelectorAll('input[name="position"]:checked');
            if (checked.length === 0) {
              loading.style.display = 'none';
              errorDiv.textContent = 'Please select at least one position.';
              errorDiv.style.display = 'block';
              form.querySelector('button[type="submit"]').disabled = false;
              return;
            }
          }
          if (form.querySelectorAll('input[name="level"]').length) {
            const checked = form.querySelectorAll('input[name="level"]:checked');
            if (checked.length === 0) {
              loading.style.display = 'none';
              errorDiv.textContent = 'Please select at least one level coached.';
              errorDiv.style.display = 'block';
              form.querySelector('button[type="submit"]').disabled = false;
              return;
            }
          }

          // Collect form data
          const formData = new FormData(form);
          const data = {};
          formData.forEach((value, key) => {
            if (data[key]) {
              if (!Array.isArray(data[key])) data[key] = [data[key]];
              data[key].push(value);
            } else {
              data[key] = value;
            }
          });

          // Capitalize first/last/city/school
          ['first', 'last', 'city', 'school'].forEach(field => {
            if (data[field]) data[field] = data[field].replace(/\b\w/g, c => c.toUpperCase());
          });

          // Get positions/levels as arrays
          if (form.querySelectorAll('input[name="position"]').length) {
            data.positions = Array.from(form.querySelectorAll('input[name="position"]:checked')).map(cb => cb.value);
          }
          if (form.querySelectorAll('input[name="level"]').length) {
            data.coachLevels = Array.from(form.querySelectorAll('input[name="level"]:checked')).map(cb => cb.value);
          }

          // Firebase registration
          try {
            // 1. Create user
            const userCredential = await firebase.auth().createUserWithEmailAndPassword(data.email, data.password);
            const user = userCredential.user;
            const userId = user.uid;

            // 2. Upload photo
            const photoFile = form.querySelector('input[type="file"]').files[0];
            const storageRef = firebase.storage().ref(`profile_photos/${userId}`);
            await storageRef.put(photoFile);
            const photoURL = await storageRef.getDownloadURL();

            // 3. Prepare Firestore data
            const userData = {
              userId,
              email: data.email,
              role: form.id.replace('form-', '').replace('-male', '').replace('-female', ''),
              firstName: data.first,
              lastName: data.last,
              state: data.state,
              city: data.city,
              phoneNumber: data.phone,
              school: data.school || '',
              teamId: data.team || '',
              photoURL,
              positions: data.positions || [],
              coachLevels: data.coachLevels || [],
              heightFt: data.heightFt || '',
              heightIn: data.heightIn || '',
              weight: data.weight || '',
              gender: data.gender || '',
            };

            await firebase.firestore().collection('users').doc(userId).set(userData);

            loading.style.display = 'none';
            successDiv.textContent = 'Registration successful! Redirecting to login...';
            successDiv.style.display = 'block';

            // Security: Remove password from memory
            if (pwInput) pwInput.value = '';
            if (confirmPwInput) confirmPwInput.value = '';

            setTimeout(() => {
              form.reset();
              form.style.display = 'none';
              window.location.href = "/users/login.html";
            }, 2000);

          } catch (err) {
            loading.style.display = 'none';
            // Friendly error messages for common Firebase errors
            let msg = err.message;
            if (err.code === 'auth/email-already-in-use') {
              msg = 'Email already in use. Please use a different email or login.';
            } else if (err.code === 'auth/invalid-email') {
              msg = 'Invalid email address.';
            } else if (err.code === 'auth/weak-password') {
              msg = 'Password is too weak. Please use at least 8 characters, including uppercase, lowercase, and a number.';
            }
            errorDiv.textContent = msg;
            errorDiv.style.display = 'block';
            form.querySelector('button[type="submit"]').disabled = false;
            if (pwInput) pwInput.value = '';
            if (confirmPwInput) confirmPwInput.value = '';
          }
        });
      });
    });
  </script>
</body>
</html>